{% extends 'extends/main_interface.html' %}

{% block aside_var %}
    {% with production_active=True %}
        {{ block.super }}
    {% endwith %}
{% endblock aside_var %}

{% block main_var %}
    {% with header=True %}
        {{ block.super }}
    {% endwith %}
{% endblock main_var %}

{% block title %}Production Management{% endblock %}

{% block header %}
<div class="flex sticky top-0 w-full bg-[#335b39] pl-6 pr-4 gap-8">
    <!-- Search Bar -->
    <div class="flex items-center justify-center gap-4 flex-1">
        <input type="text" id="production-search" class="w-[60%] p-2 border rounded-lg" placeholder="Search production jobs...">
    </div>

    <div class="flex basis-[20%] justify-end">
        <!-- Inventory Management Button -->
        <button class="bg-green-700 text-white px-4 py-2 rounded-lg flex items-center gap-2">
            <i class="fas fa-cogs"></i>
        </button>
        <!-- Add New Production Button -->
        <button class="bg-blue-600 text-white px-4 py-2 rounded-lg flex items-center gap-2 ml-4">
            <i class="fas fa-plus"></i>
        </button>

        <!-- Notification Button -->
        <button class="px-4 py-2 rounded-lg flex items-center gap-2 ml-4">
            <i class="fas fa-bell text-yellow-400 font-bold text-2xl"></i>
        </button>
    </div>
</div>
{% endblock %}

{% block content %}
<div class="flex-1 flex flex-col pl-3 py-3 pr-2 bg-gray-50 relative">
    <div class="flex justify-center gap-4 border-b border-green-500">
        <button class="production-tab text-lg pb-2 border-b-4 border-green-500 font-semibold" data-tab="0">
            <i class="fas fa-calendar-alt text-green-700"></i> Job Scheduling
        </button>
        <button class="production-tab text-lg pb-2" data-tab="1">
            <i class="fas fa-chart-line text-green-700"></i> Production Tracking
        </button>
        <button class="production-tab text-lg pb-2" data-tab="2">
            <i class="fas fa-check-circle text-green-700"></i> Quality Control
        </button>
    </div>
    
    <!-- Glide.js Slider -->
    <div class="glide mt-4">
        <div class="glide__track" data-glide-el="track">
            <ul class="glide__slides">
                <!-- Job Scheduling Tab -->
                <li class="glide__slide p-6 box-content flex items-center justify-center">
                    {% include 'includes/production/production_jobscheduling.html' %}
                </li>
                <!-- Production Tracking Tab -->
                <li class="glide__slide p-6 box-content flex items-center justify-center">
                    {% include 'includes/production/production_tracking.html' %}
                </li>
                <!-- Quality Control Tab -->
                <li class="glide__slide p-6 box-content flex items-center justify-center">
                    {% include 'includes/production/production_qualitycontrol.html' %}
                </li>
            </ul>
        </div>
        <!-- Pagination -->
        <div class="glide__bullets" data-glide-el="controls[nav]">
            <button class="glide__bullet" data-glide-dir="=0"></button>
            <button class="glide__bullet" data-glide-dir="=1"></button>
            <button class="glide__bullet" data-glide-dir="=2"></button>
        </div>
    </div>
</div>

<!-- JavaScript Initialization -->
<script>
    document.addEventListener('DOMContentLoaded', () => {
        // Initialize Glide.js
        const glide = new Glide('.glide', {
            type: 'slider',
            startAt: 0,
            perView: 1,
            gap: 20,
            animationDuration: 500,
        });

        glide.mount();

        // Tab click logic to change slides
        const tabs = document.querySelectorAll('.production-tab');
        tabs.forEach((tab, index) => {
            tab.addEventListener('click', () => {
                glide.go(`=${index}`);
                tabs.forEach(t => t.classList.remove('border-b-4', 'border-green-500', 'font-semibold'));
                tab.classList.add('border-b-4', 'border-green-500', 'font-semibold');
            });
        });

        // Sync active tab with current slide
        glide.on('run.after', () => {
            const activeIndex = glide.index;
            tabs.forEach(t => t.classList.remove('border-b-4', 'border-green-500', 'font-semibold'));
            tabs[activeIndex].classList.add('border-b-4', 'border-green-500', 'font-semibold');
        });
    });
</script>
{% endblock %}

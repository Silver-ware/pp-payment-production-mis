{% extends 'extends/setup_interface.html' %}

{% block title %}
  Customer Preload of Data
{% endblock %}

{% block section_title %}
  CUSTOMER PRELOAD DATA
{% endblock %}

{% block section_des %}
  Suggested customer details are those who are regular and have recent and frequent purchase. 
  Ensure that you provide complete and accurate information.<br>
  Fields marked with <span class="font-bold text-red-500">*</span> are required.
{% endblock %}

{% block form_heading %} Add Customer Data (optional) {% endblock %}

{% comment %} Setting variables that the parent utilizes {% endcomment %}
{% block left_section_var %}
  {% with prev_background="linear-gradient(to bottom right, #2e2e2e, #2b3f78, #556b2f)" next_background="linear-gradient(to bottom right, #6b8e23, #0b1e31, #2f2f2f)" %}
    {{block.super}}
  {% endwith %}
{% endblock left_section_var %}

{% block form_block %}
  {% with form_id="customer_form" next_url='system_settings' prev=True prev_url='supplier' %}
    {{block.super}}
  {% endwith %}
{% endblock %}

{% block form_fields %}
<div class="space-y-4 w-full">
  <!-- Full Name -->
  <div>
    <label class="block text-sm font-semibold text-gray-700">
      <i class="fas fa-user text-green-600"></i> Full Name: <span class="text-red-500">*</span>
    </label>
    <div class="flex gap-4 mt-1">
      <input type="text" name="name" id="name" hidden>
      <input type="text" id="surname" name="surname" 
        class="flex-1 w-1/3 p-3 border rounded-lg focus:ring-green-500 focus:border-green-500"
        placeholder="Surname" required>
      <input type="text" id="first_name" name="first_name" 
        class="w-1/3 p-3 border rounded-lg focus:ring-green-500 focus:border-green-500"
        placeholder="First Name" required>
      <input type="text" id="middle_initial" name="middle_initial" 
        class="w-1/6 p-3 border rounded-lg focus:ring-green-500 focus:border-green-500"
        placeholder="M.I." maxlength="1">
      {% if form.name.errors %}
        <div class="error text-red-500">
            {% for error in form.name.errors %}
                <p>{{ error }}</p>
            {% endfor %}
        </div>
      {% endif %}
    </div>
    <script>
      document.querySelector('form').addEventListener('submit', function() {
        var surname = document.getElementById('surname').value;
        var first_name = document.getElementById('first_name').value;
        var middle_initial = document.getElementById('middle_initial').value;
    
        // Concatenate the values and set it to the hidden name field
        var full_name = (surname + ", " + first_name + " " + middle_initial).trim();
        document.getElementById('name').value = full_name;
      });
    </script>
  </div>
  <!-- Phone Number and Email in the same row -->
  <div class="grid grid-cols-2 gap-4">
    <div>
      <label for="contact_number" class="block text-sm font-semibold text-gray-700">
        <i class="fas fa-phone text-green-600"></i> Contact Number: <span class="text-red-500">*</span>
      </label>
      <input type="tel" id="contact_number" name="contact_number" 
        class="w-full mt-1 p-3 border rounded-lg focus:ring-green-500 focus:border-green-500"
        placeholder="Enter contact number" required>
      {% if form.contact_number.errors %}
        <div class="error text-red-500">
            {% for error in form.contact_number.errors %}
                <p>{{ error }}</p>
            {% endfor %}
        </div>
      {% endif %}
    </div>
    <div>
      <label for="email" class="block text-sm font-semibold text-gray-700">
        <i class="fas fa-envelope text-green-600"></i> Email Address: <span class="text-red-500">*</span>
      </label>
      <input type="email" id="email" name="email"
             class="w-full mt-1 p-3 border rounded-lg focus:ring-green-500 focus:border-green-500"
             placeholder="Enter email address" required>
      {% if form.email.errors %}
        <div class="error text-red-500">
            {% for error in form.email.errors %}
                <p>{{ error }}</p>
            {% endfor %}
        </div>
      {% endif %}
    </div>
  </div>

    <!-- Address Field -->
    <div>
      <label for="address" class="block text-sm font-semibold text-gray-700">
        <i class="fas fa-map-marker-alt text-green-600"></i> Address:
      </label>
      <input type="text" id="address" name="address"
                class="w-full mt-1 p-3 border rounded-lg focus:ring-green-500 focus:border-green-500"
                placeholder="Enter supplier's address">
    </div>
</div>

<!-- Submit Button -->
<div class="mt-8 flex justify-end">
  <button type="submit" class="px-6 py-2 bg-green-600 text-white font-semibold rounded-lg hover:bg-green-700 focus:ring-2 focus:ring-green-500">
    <i class="fas fa-check-circle"></i> Add Customer
  </button>
</div>
{% endblock %}

{% block messages %}
  {% if messages %}
  <div 
    id="success-message" 
    class="absolute bottom-[6.5rem] left-[5.5rem] z-50 px-4 py-2 text-green-800 bg-green-200 border border-green-300 rounded shadow-lg">
    {% for message in messages %}
      {{ message }}
    {% endfor %}
  </div>
  {% endif %}
  <script>
    // Fade out the success message after 3 seconds
    document.addEventListener('DOMContentLoaded', function () {
      const successMessage = document.getElementById('success-message');
      if (successMessage) {
        setTimeout(() => {
          successMessage.style.transition = 'opacity 0.5s ease';
          successMessage.style.opacity = '0';
          setTimeout(() => successMessage.remove(), 500); // Remove after fade-out
        }, 3000); // 3 seconds delay before starting fade-out
      }
    });
  </script>
{% endblock messages %}
